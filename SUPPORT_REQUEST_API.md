# API для отправки обращений в службу поддержки

## Описание
Новый эндпоинт позволяет пользователям отправлять обращения в службу поддержки NinjaTraining. Обращения отправляются на email адрес, указанный в настройках приложения.

## Эндпоинт
`POST /service/support-request/`

## Аутентификация
Требуется аутентификация пользователя через токен.

## Параметры запроса

### Тело запроса (JSON)
```json
{
    "request_type": "string",     // Тип обращения (обязательно, 1-100 символов)
    "message": "string",          // Сообщение (обязательно, 1-2000 символов)
    "user_uuid": "uuid"          // UUID пользователя (обязательно)
}
```

### Пример запроса
```json
{
    "request_type": "Техническая проблема",
    "message": "У меня не работает функция поиска упражнений. При вводе запроса ничего не находится.",
    "user_uuid": "123e4567-e89b-12d3-a456-426614174000"
}
```

## Ответы

### Успешный ответ (200 OK)
```json
{
    "success": true,
    "message": "Ваше обращение успешно отправлено в службу поддержки"
}
```

### Ошибки

#### 403 Forbidden - Недостаточно прав
```json
{
    "detail": "Вы можете отправлять обращения только от своего имени"
}
```

#### 404 Not Found - Пользователь не найден
```json
{
    "detail": "Пользователь не найден"
}
```

#### 500 Internal Server Error - Ошибка отправки
```json
{
    "detail": "Ошибка при отправке обращения: [описание ошибки]"
}
```

## Формат отправляемого письма

Письмо отправляется на адрес, указанный в `MAIL_FROM` в настройках приложения, с темой "Новое обращение от пользователя NinjaTraining".

Содержимое письма включает:
- Информацию о пользователе (email, имя)
- Тип обращения
- Сообщение пользователя
- Автоматическую подпись

## Пример использования

### cURL
```bash
curl -X POST "http://localhost:8000/service/support-request/" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "request_type": "Техническая проблема",
    "message": "Описание проблемы...",
    "user_uuid": "123e4567-e89b-12d3-a456-426614174000"
  }'
```

### Python
```python
import requests

response = requests.post(
    "http://localhost:8000/service/support-request/",
    json={
        "request_type": "Техническая проблема",
        "message": "Описание проблемы...",
        "user_uuid": "123e4567-e89b-12d3-a456-426614174000"
    },
    headers={"Authorization": "Bearer YOUR_TOKEN"}
)
```

## Настройка email

Убедитесь, что в файле `.env` или переменных окружения настроены следующие параметры:

```env
MAIL_USERNAME=your_email@gmail.com
MAIL_PASSWORD=your_app_password
MAIL_FROM=your_email@gmail.com
MAIL_PORT=587
MAIL_SERVER=smtp.gmail.com
```

## Логирование

Все операции логируются с уровнем INFO. В случае ошибок создаются записи с уровнем ERROR, содержащие детали проблемы.



